# Product Status - Usage

The product status provides information on the status products in the `product_tree` are in.

Generally, vulnerable (`known_affected`) and fixed (`fixes`) versions of products should be given.

The different lists of product status groups contain the IDs of corresponding products.
The same product ID must not be member of contradicting product status groups.
I.e. a product listed in the group of _affected_ products must not be listed again in the group of _not affected_ products.

The contradicting groups are

* _affected_

  * `product_status/first_affected[]`
  * `product_status/known_affected[]`
  * `product_status/last_affected[]`

* _not affected_

  * `product_status/known_not_affected[]`

* _fixed_

  * `product_status/first_fixed[]`
  * `product_status/fixed[]`

* _under investigation_

  * `product_status/under_investigation[]`

Each product listed in the _affected_ group should be referenced in at least one remediation item (`/vulnerabilities[]/remediations`).

For each product listed in the _not affected_ group, the reason why it is not affected should be given.
This reason, also called impact statement, should be listed in the threats (`/vulnerabilities[]/threats`) with category `impact` or as machine-readable status justification in the flags (`/vulnerabilities[]/flags`).
It is recommended to use both, when applicable.

The status `known_not_affected` is used in the context of security advisories to exclude individual products. This is mainly used for products one could assume to be affected.
To define general non-affectedness, the VEX profile should be used.

An issuer might recommend (`product_status/recommended`) a product version from any group.
If more than one product version is patched, the author should also specify which version is recommended.
A recommended product version can also come from the _affected_ group, i.e. if it was discovered that fixed versions introduce a more severe vulnerability.
If there are two patched versions of a vulnerability that contain different vulnerabilities, the `recommended` field can also be used to specify which version is recommended for use.

Version boundaries can be represented in the `first_*` and `last_*` fields.
For simplification, elements from `first_*` and `last_*` should also be listed in the main groups `known_*`.

For products listed in `under_investigation` it is expected that the outcome of analysis are reported in a later version of the document.

For the `csaf_security_advisory` profile the property `product_status` must exist.

For the `csaf_vex` profile at least one of the elements `fixed`, `known_affected`, `known_not_affected` or `under_investigation` must be present.
